<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>MoonVeil â€“ All Features Enabled</title>
</head>
<body>
    <h1>MoonVeil Obfuscator (All Features)</h1>

    <textarea id="inputScript" rows="12" cols="70"
        placeholder="Paste your Luau script here..."></textarea>
    <br><br>

    <button id="obfuscateBtn">Obfuscate (Max)</button>

    <h2>Obfuscated Output</h2>
    <textarea id="output" rows="12" cols="70" readonly></textarea>

    <script>
        document.getElementById("obfuscateBtn").onclick = async () => {
            const script = document.getElementById("inputScript").value;
            if (!script) return alert("No script provided.");

            try {
                const res = await fetch("https://moonveil.cc/api/obfuscate", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        "Authorization": "Bearer mv-secret-484470fb-0fa7-48ef-b203-90d96d2f42a1"
                    },
                    body: JSON.stringify({
                        script: script,
                        options: {
                            // Core
                            vm: true,
                            controlFlow: true,
                            stringEncryption: true,
                            constantEncryption: true,

                            // Anti-analysis
                            antiTamper: true,
                            antiDebug: true,
                            antiBeautify: true,
                            antiDump: true,

                            // Transformations
                            renameVariables: true,
                            renameFunctions: true,
                            flatten: true,
                            opaquePredicates: true,

                            // Output
                            minify: true,
                            prettify: false,

                            // Aggressive / experimental
                            aggressive: true,
                            virtualization: true
                        }
                    })
                });

                if (!res.ok) {
                    throw new Error(await res.text());
                }

                const data = await res.json();
                document.getElementById("output").value =
                    data.obfuscated ?? JSON.stringify(data, null, 2);

            } catch (e) {
                alert("Error: " + e.message);
                console.error(e);
            }
        };
    </script>
</body>
</html>
